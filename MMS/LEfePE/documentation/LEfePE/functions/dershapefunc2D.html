<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of dershapefunc2D</title>
  <meta name="keywords" content="dershapefunc2D">
  <meta name="description" content="2D Basis function derivatives and Gauss point weights">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../menu.html">Home</a> &gt;  <a href="../menu.html">LEfePE</a> &gt; <a href="menu.html">functions</a> &gt; dershapefunc2D.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../menu.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="menu.html">Index for LEfePE/functions&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>dershapefunc2D
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>2D Basis function derivatives and Gauss point weights</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [wp,dNr]=dershapefunc2D(ngp,nen) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">2D Basis function derivatives and Gauss point weights
--------------------------------------------------------------------------
 Author: William Coombs
 Date:   30/09/2020
 Description:
 Function to determine derivatives of the basis functions (shape
 functions) with respect to the local coordinates and the weights of the 
 Gauss points that are used to integrate the finite elements. 
 
 Elements included:
   -  3 noded linear triangle
   -  4 noded linear quadrilateral
   -  8 noded quadratic quadrilateral
   -  9 noded quadratic quadrilateral

--------------------------------------------------------------------------
 [wp,dNr,gp] = DERSHAPEFUNC2D(ngp,nen)
--------------------------------------------------------------------------
 Input(s):
 ngp   - number of Gauss points used to integrate the element
 nen   - number of nodes for each element
--------------------------------------------------------------------------
 Ouput(s);
 wp    - Gauss point weights (ngp,1)
 dNr   - derivatives of the basis functions with respect to local position
         evaluated at all Gauss point locations (nD*ngp,nen) 
--------------------------------------------------------------------------
 See also:

--------------------------------------------------------------------------</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../LEfePE/LEfe2dpe.html" class="code" title="">LEfe2dpe</a>	LEfe2dpe: 2D plane strain Linear Elastic finite element solver</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [wp,dNr]=dershapefunc2D(ngp,nen)</a>
0002 
0003 <span class="comment">%2D Basis function derivatives and Gauss point weights</span>
0004 <span class="comment">%--------------------------------------------------------------------------</span>
0005 <span class="comment">% Author: William Coombs</span>
0006 <span class="comment">% Date:   30/09/2020</span>
0007 <span class="comment">% Description:</span>
0008 <span class="comment">% Function to determine derivatives of the basis functions (shape</span>
0009 <span class="comment">% functions) with respect to the local coordinates and the weights of the</span>
0010 <span class="comment">% Gauss points that are used to integrate the finite elements.</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% Elements included:</span>
0013 <span class="comment">%   -  3 noded linear triangle</span>
0014 <span class="comment">%   -  4 noded linear quadrilateral</span>
0015 <span class="comment">%   -  8 noded quadratic quadrilateral</span>
0016 <span class="comment">%   -  9 noded quadratic quadrilateral</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%--------------------------------------------------------------------------</span>
0019 <span class="comment">% [wp,dNr,gp] = DERSHAPEFUNC2D(ngp,nen)</span>
0020 <span class="comment">%--------------------------------------------------------------------------</span>
0021 <span class="comment">% Input(s):</span>
0022 <span class="comment">% ngp   - number of Gauss points used to integrate the element</span>
0023 <span class="comment">% nen   - number of nodes for each element</span>
0024 <span class="comment">%--------------------------------------------------------------------------</span>
0025 <span class="comment">% Ouput(s);</span>
0026 <span class="comment">% wp    - Gauss point weights (ngp,1)</span>
0027 <span class="comment">% dNr   - derivatives of the basis functions with respect to local position</span>
0028 <span class="comment">%         evaluated at all Gauss point locations (nD*ngp,nen)</span>
0029 <span class="comment">%--------------------------------------------------------------------------</span>
0030 <span class="comment">% See also:</span>
0031 <span class="comment">%</span>
0032 <span class="comment">%--------------------------------------------------------------------------</span>
0033 
0034 <span class="comment">%% Gauss point information</span>
0035 <span class="keyword">if</span> ngp==1 &amp;&amp; nen==3
0036   gp = [1 1]/4;
0037   wp = 1/2;
0038 <span class="keyword">elseif</span> ngp==1
0039   gp = [0 0];
0040   wp = 8;
0041 <span class="keyword">elseif</span> ngp==4
0042   g2=1/sqrt(3);
0043   gp(:,1)=[-1 -1 1 1].'*g2;
0044   gp(:,2)=[-1 1 1 -1].'*g2;
0045   wp=ones(4,1);
0046 <span class="keyword">else</span>
0047   g2=sqrt(3/5);
0048   gp(:,1)=[-1 -1 -1  0  0  0  1  1  1].'*g2;
0049   gp(:,2)=[-1  1  0 -1  1  0 -1  1  0].'*g2;
0050   wp1=[5/9 5/9 5/9 8/9 8/9 8/9 5/9 5/9 5/9].';
0051   wp2=[5/9 5/9 8/9 5/9 5/9 8/9 5/9 5/9 8/9].';
0052   wp=wp1.*wp2;  
0053 <span class="keyword">end</span>
0054 
0055 <span class="comment">%% Basis/shape function derivatives</span>
0056 xsi=gp(:,1); eta=gp(:,2); r2=ngp*2;
0057 <span class="keyword">if</span> nen==8
0058   dNr(1:2:r2,1)=1/4*(2*xsi+eta).*(1-eta);
0059   dNr(1:2:r2,2)=-1/2*(1-eta.^2);
0060   dNr(1:2:r2,3)=1/4*(2*xsi-eta).*(1+eta); 
0061   dNr(1:2:r2,4)=-xsi.*(1+eta);
0062   dNr(1:2:r2,5)=1/4*(1+eta).*(2*xsi+eta);
0063   dNr(1:2:r2,6)=1/2*(1-eta.^2);
0064   dNr(1:2:r2,7)=1/4*(1-eta).*(2*xsi-eta); 
0065   dNr(1:2:r2,8)=-xsi.*(1-eta);
0066   dNr(2:2:r2+1,1)=1/4*(1-xsi).*(xsi+2*eta);
0067   dNr(2:2:r2+1,2)=-eta.*(1-xsi);
0068   dNr(2:2:r2+1,3)=1/4*(1-xsi).*(2*eta-xsi); 
0069   dNr(2:2:r2+1,4)=1/2*(1-xsi.^2);
0070   dNr(2:2:r2+1,5)=1/4*(1+xsi).*(2*eta+xsi);
0071   dNr(2:2:r2+1,6)=-eta.*(1+xsi);
0072   dNr(2:2:r2+1,7)=1/4*(1+xsi).*(2*eta-xsi);
0073   dNr(2:2:r2+1,8)=-1/2*(1-xsi.^2);
0074 <span class="keyword">elseif</span> nen==9
0075   dNr(1:2:r2,1)= 1/4*eta.*(eta-1).*(2*xsi-1);
0076   dNr(1:2:r2,2)=-1/2*(eta+1).*(eta-1).*(2*xsi-1);
0077   dNr(1:2:r2,3)= 1/4*eta.*(eta+1).*(2*xsi-1);
0078   dNr(1:2:r2,4)=-1*eta.*(eta+1).*xsi;
0079   dNr(1:2:r2,5)= 1/4*eta.*(eta+1).*(2*xsi+1);
0080   dNr(1:2:r2,6)=-1/2*(eta+1).*(eta-1).*(2*xsi+1);
0081   dNr(1:2:r2,7)= 1/4*eta.*(eta-1).*(2*xsi+1);
0082   dNr(1:2:r2,8)=-1*eta.*(eta-1).*xsi;
0083   dNr(1:2:r2,9)= 2*(eta+1).*(eta-1).*xsi;
0084   
0085   dNr(2:2:r2+1,1)= 1/4*xsi.*(xsi-1).*(2*eta-1);
0086   dNr(2:2:r2+1,2)= -1*xsi.*(xsi-1).*eta;
0087   dNr(2:2:r2+1,3)= 1/4*xsi.*(xsi-1).*(2*eta+1);
0088   dNr(2:2:r2+1,4)=-1/2*(xsi+1).*(xsi-1).*(2*eta+1);
0089   dNr(2:2:r2+1,5)= 1/4*xsi.*(xsi+1).*(2*eta+1);
0090   dNr(2:2:r2+1,6)=-1*xsi.*(xsi+1).*eta;
0091   dNr(2:2:r2+1,7)= 1/4*xsi.*(xsi+1).*(2*eta-1);
0092   dNr(2:2:r2+1,8)=-1/2*(xsi+1).*(xsi-1).*(2*eta-1); 
0093   dNr(2:2:r2+1,9)= 2*(xsi+1).*(xsi-1).*eta;
0094 <span class="keyword">elseif</span> nen==4
0095   dNr(1:2:r2,1)  =-1/4*(1-eta);
0096   dNr(1:2:r2,2)  =-1/4*(1+eta);
0097   dNr(1:2:r2,3)  = 1/4*(1+eta);
0098   dNr(1:2:r2,4)  = 1/4*(1-eta);
0099   dNr(2:2:r2+1,1)=-1/4*(1-xsi);
0100   dNr(2:2:r2+1,2)= 1/4*(1-xsi);
0101   dNr(2:2:r2+1,3)= 1/4*(1+xsi);
0102   dNr(2:2:r2+1,4)=-1/4*(1+xsi);
0103 <span class="keyword">elseif</span> nen==3
0104   dNr(1:2:r2,1)  =-1;
0105   dNr(1:2:r2,2)  = 1;
0106   dNr(1:2:r2,3)  = 0;
0107   dNr(2:2:r2+1,1)=-1;
0108   dNr(2:2:r2+1,2)= 0;
0109   dNr(2:2:r2+1,3)= 1;
0110 <span class="keyword">end</span>
0111 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 12-Nov-2020 10:12:47 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>